SELECT D.ID AS NLIGNE,D.COMPTE AS NUMERO_DE_COMPTE,C.CODE_AGENCE AS CODE_AGENCE,
D.NBRCHQ AS NBRE_CARNET,D.COMPTE,DT.REFER2 - DT.REFER1 +1 AS NBRE_FEUILES,
01 AS CODE_TRANSACTION ,c.NOM AS NOMCLIENT ,D.ADRL1 AS ADDRESSE,929 AS CODE_DEVISE,00026 AS CODE_BANK,02 AS CODE_PAYS ,D.REFER1 AS NUMERO_DE_DEBUT
FROM DEMCHQ D 
JOIN client C ON D.CLIENT = C.CODE_RACINE
JOIN AGENCE a ON c.CODE_AGENCE = a.AGENCE
JOIN DEMCHQDTL DT ON D.NOOPER = DT. CHECKBK_NOOPER
WHERE D.DATVALID IS NOT NULL;

SELECT D.COMPTE AS NUMERO_DE_COMPTE,C.CODE_AGENCE AS CODE_AGENCE,
D.NBRCHQ AS NBRE_CARNET,D.COMPTE,DT.REFER2 - DT.REFER1 +1 AS NBRE_FEUILES,
01 AS CODE_TRANSACTION ,c.NOM AS NOMCLIENT ,D.ADRL3 AS ADDRESSE,929 AS CODE_DEVISE,00026 AS CODE_BANK,02 AS CODE_PAYS ,D.REFER1 AS NUMERO_DE_DEBUT
FROM DEMCHQ D 
JOIN client C ON D.CLIENT = C.CODE_RACINE
JOIN AGENCE a ON c.CODE_AGENCE = a.AGENCE
JOIN DEMCHQDTL DT ON D.NOOPER = DT. CHECKBK_NOOPER
WHERE D.DATVALID IS NOT NULL;